#!/bin/sh

set -e

export LC_ALL=C
unset LANG
unset LANGUAGE

USE_PAM="yes"

succeded=0
failed=0
failed_tests=""

run_test()
{
	if $1 > $1.log
	then
		succeded=$((succeded+1))
		echo -n "+"
	else
		failed=$((failed+1))
		failed_tests="$failed_tests $1"
		echo -n "-"
	fi
	cat $1.log >> testsuite.log
	[ -f /etc/passwd.lock ] && echo $1 /etc/passwd.lock || true
	[ -f /etc/group.lock ] && echo $1 /etc/group.lock || true
	[ -f /etc/shadow.lock ] && echo $1 /etc/shadow.lock || true
	[ -f /etc/gshadow.lock ] && echo $1 /etc/gshadow.lock || true
}

echo "+: test passed"
echo "-: test failed"

# Empty the complete log.
> testsuite.log

run_test ./su/01/su_root.test
run_test ./su/01/su_user.test
run_test ./su/02/env_FOO-options_--login
run_test ./su/02/env_FOO-options_--login_bash
run_test ./su/02/env_FOO-options_--preserve-environment
run_test ./su/02/env_FOO-options_--preserve-environment_bash
run_test ./su/02/env_FOO-options_-
run_test ./su/02/env_FOO-options_-_bash
run_test ./su/02/env_FOO-options_-l-m
run_test ./su/02/env_FOO-options_-l-m_bash
run_test ./su/02/env_FOO-options_-l
run_test ./su/02/env_FOO-options_-l_bash
run_test ./su/02/env_FOO-options_-m_bash
run_test ./su/02/env_FOO-options_-m
run_test ./su/02/env_FOO-options_-p
run_test ./su/02/env_FOO-options_-p_bash
run_test ./su/02/env_FOO-options__bash
run_test ./su/02/env_FOO-options_
run_test ./su/02/env_FOO-options_-p-
run_test ./su/02/env_FOO-options_-p-_bash
run_test ./su/02/env_special-options_-l-p
run_test ./su/02/env_special-options_-l
run_test ./su/02/env_special-options_-l-p_bash
run_test ./su/02/env_special-options_-l_bash
run_test ./su/02/env_special-options_-p
run_test ./su/02/env_special-options_-p_bash
run_test ./su/02/env_special-options_
run_test ./su/02/env_special-options__bash
run_test ./su/02/env_special_root-options_-l-p
run_test ./su/02/env_special_root-options_-l-p_bash
run_test ./su/02/env_special_root-options_-l
run_test ./su/02/env_special_root-options_-l_bash
run_test ./su/02/env_special_root-options_-p
run_test ./su/02/env_special_root-options_-p_bash
run_test ./su/02/env_special_root-options_
run_test ./su/02/env_special_root-options__bash
run_test ./su/03/su_run_command01.test
run_test ./su/03/su_run_command02.test
run_test ./su/03/su_run_command03.test
run_test ./su/03/su_run_command04.test
run_test ./su/03/su_run_command05.test
run_test ./su/03/su_run_command06.test
run_test ./su/03/su_run_command07.test
run_test ./su/03/su_run_command08.test
run_test ./su/03/su_run_command09.test
run_test ./su/03/su_run_command10.test
run_test ./su/03/su_run_command11.test
run_test ./su/03/su_run_command12.test
run_test ./su/03/su_run_command13.test
run_test ./su/03/su_run_command14.test
run_test ./su/03/su_run_command15.test
run_test ./su/03/su_run_command16.test
run_test ./su/03/su_run_command17.test
run_test ./su/04/su_wrong_user.test
run_test ./su/04/su_user_wrong_passwd.test
run_test ./su/04/su_user_wrong_passwd_syslog.test
run_test ./su/05/su_user_wrong_passwd_syslog.test
run_test ./su/06/su_user_syslog.test
run_test ./su/07/su_user_syslog.test
run_test ./su/08/env_special-options_
run_test ./su/08/env_special_root-options_
run_test ./su/09/env_special-options_
run_test ./su/09/env_special_root-options_
run_test ./su/10_su_sulog_success/su.test
run_test ./su/11_su_sulog_failure/su.test
run_test ./convtools/01/run
run_test ./convtools/02_grpconv_remove_gshadow_only_entries/grpconv.test
run_test ./convtools/03_grpconv_copy_passwd/grpconv.test
run_test ./convtools/04_grpconv_no_password/grpconv.test
run_test ./convtools/05_grpconv_copy_passwd_existing_gshadow/grpconv.test
run_test ./convtools/06_grpconv_error_group_locked/grpconv.test
run_test ./convtools/07_grpconv_error_gshadow_locked/grpconv.test
run_test ./convtools/08_grpunconv_no_gshadow_file/grpunconv.test
run_test ./convtools/09_grpunconv_error_group_locked/grpunconv.test
run_test ./convtools/10_grpunconv_error_gshadow_locked/grpunconv.test
run_test ./convtools/11_pwconv_error_passwd_locked/pwconv.test
run_test ./convtools/12_pwconv_error_shadow_locked/pwconv.test
run_test ./convtools/13_pwunconv_error_passwd_locked/pwunconv.test
run_test ./convtools/14_pwunconv_error_shadow_locked/pwunconv.test
run_test ./convtools/15_pwconv_remove_shadow_only_entries/pwconv.test
run_test ./convtools/16_pwconv_copy_passwd/pwconv.test
run_test ./convtools/17_pwunconv_no_shadow_file/pwunconv.test
run_test ./convtools/18_pwunconv_user_not_in_shadow/pwunconv.test
run_test ./chage/01/run
run_test ./chage/02/run
run_test ./chsh/01/run
run_test ./debian/01/run
run_test ./grouptools/chgpasswd/01_chgpasswd_invalid_group/chgpasswd.test
run_test ./grouptools/chgpasswd/02_chgpasswd_multiple_groups/chgpasswd.test
run_test ./grouptools/chgpasswd/03_chgpasswd_no_gshadow_file/chgpasswd.test
run_test ./grouptools/chgpasswd/04_chgpasswd_no_gshadow_entry/chgpasswd.test
run_test ./grouptools/chgpasswd/05_chgpasswd_error_no_password/chgpasswd.test
run_test ./grouptools/gpasswd/01_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/02_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/03_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/04_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/05_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/06_gpasswd_change_member_list/gpasswd.test
run_test ./grouptools/gpasswd/07_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/08_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/09_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/10_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/11_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/12_gpasswd_change_member_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/13_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/14_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/15_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/16_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/17_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/18_gpasswd_change_member_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/19_gpasswd_change_passwd-root/gpasswd.test
run_test ./grouptools/gpasswd/20_gpasswd_change_passwd-root-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/21_gpasswd_change_passwd-root-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/22_gpasswd_change_passwd-myuser/gpasswd.test
run_test ./grouptools/gpasswd/23_gpasswd_change_passwd-myuser-denied/gpasswd.test
run_test ./grouptools/gpasswd/24_gpasswd_change_passwd-myuser-denied-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/25_gpasswd_remove_password/gpasswd.test
run_test ./grouptools/gpasswd/26_gpasswd_remove_password-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/27_gpasswd_remove_password-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/28_gpasswd_lock_password/gpasswd.test
run_test ./grouptools/gpasswd/29_gpasswd_lock_password-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/30_gpasswd_lock_password-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/31_gpasswd_add_user_to_group/gpasswd.test
run_test ./grouptools/gpasswd/32_gpasswd_add_user_to_group-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/33_gpasswd_add_user_to_group-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/34_gpasswd_remove_user_from_group/gpasswd.test
run_test ./grouptools/gpasswd/35_gpasswd_remove_user_from_group/gpasswd.test
run_test ./grouptools/gpasswd/36_gpasswd_remove_user_from_group/gpasswd.test
run_test ./grouptools/gpasswd/37_gpasswd_remove_user_from_group-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/38_gpasswd_remove_user_from_group-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/39_gpasswd_remove_user_from_group-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/40_gpasswd_remove_user_from_group-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/41_gpasswd_remove_user_from_group-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/42_gpasswd_remove_user_from_group-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/43_gpasswd_-r_locked_group/gpasswd.test
run_test ./grouptools/gpasswd/44_gpasswd_-r_locked_gshadow/gpasswd.test
run_test ./grouptools/gpasswd/45_gpasswd_-r_unknown_group/gpasswd.test
run_test ./grouptools/gpasswd/46_gpasswd_-a_unknown_user/gpasswd.test
run_test ./grouptools/gpasswd/47_gpasswd_-M_unknown_user/gpasswd.test
run_test ./grouptools/gpasswd/48_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/49_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/50_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/51_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/52_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/53_gpasswd_change_admin_list/gpasswd.test
run_test ./grouptools/gpasswd/54_gpasswd_change_admin_list-no_shadow_group/gpasswd.test
run_test ./grouptools/gpasswd/55_gpasswd_change_admin_list-no_gshadow_file/gpasswd.test
run_test ./grouptools/gpasswd/56_gpasswd_add_user_to_group/gpasswd.test
run_test ./grouptools/gpasswd/57_gpasswd_remove_user_from_group-not_member/gpasswd.test
run_test ./grouptools/gpasswd/58_gpasswd_remove_user_from_group-not_gshadow_member/gpasswd.test
run_test ./grouptools/gpasswd/59_gpasswd_remove_user_from_group-not_group_member/gpasswd.test
run_test ./grouptools/gpasswd/60_gpasswd_add_long_user_to_group/gpasswd.test
run_test ./grouptools/groupadd/01_groupadd_add_group/groupadd.test
run_test ./grouptools/groupadd/02_groupadd_add_group_GID_MIN/groupadd.test
run_test ./grouptools/groupadd/03_groupadd_add_group_-K_GID_MIN/groupadd.test
run_test ./grouptools/groupadd/04_groupadd_set_password/groupadd.test
run_test ./grouptools/groupadd/05_groupadd_set_GID/groupadd.test
run_test ./grouptools/groupadd/06_groupadd_-f_add_existing_group/groupadd.test
run_test ./grouptools/groupadd/07_groupadd_-f_add_existing_GID/groupadd.test
run_test ./grouptools/groupadd/08_groupadd_locked_group/groupadd.test
run_test ./grouptools/groupadd/09_groupadd_locked_gshadow/groupadd.test
run_test ./grouptools/groupadd/10_groupadd_-o_add_existing_GID/groupadd.test
run_test ./grouptools/groupadd/11_groupadd_invalid_GID/groupadd.test
run_test ./grouptools/groupadd/12_groupadd_negativ_GID/groupadd.test
run_test ./grouptools/groupadd/13_groupadd_invalid_name/groupadd.test
run_test ./grouptools/groupadd/14_groupadd_invalid_-K_option/groupadd.test
run_test ./grouptools/groupadd/15_groupadd_invalid_-K_no_=/groupadd.test
run_test ./grouptools/groupadd/16_groupadd_existing_group/groupadd.test
run_test ./grouptools/groupadd/17_groupadd_add_systemgroup/groupadd.test
run_test ./grouptools/groupadd/18_groupadd_no_more_GID/groupadd.test
run_test ./grouptools/groupadd/19_groupadd_-r_no_more_system_GID/groupadd.test
run_test ./grouptools/groupadd/20_groupadd_add_existing_GID/groupadd.test
run_test ./grouptools/groupadd/21_groupadd_invalid_GID_4294967295/groupadd.test
run_test ./grouptools/groupdel/01_groupdel_delete_group/groupdel.test
run_test ./grouptools/groupdel/02_groupdel_delete_group_no_gshadow_group/groupdel.test
run_test ./grouptools/groupdel/03_groupdel_delete_group_no_gshadow_file/groupdel.test
run_test ./grouptools/groupdel/04_groupdel_delete_group_error_busy_group/groupdel.test
run_test ./grouptools/groupdel/05_groupdel_delete_group_error_unknown_group/groupdel.test
run_test ./grouptools/groupdel/06_groupdel_delete_group_error_locked_group/groupdel.test
run_test ./grouptools/groupdel/07_groupdel_delete_group_error_locked_gshadow/groupdel.test
run_test ./grouptools/groupdel/08_groupdel_delete_group_error_no_group_parameter/groupdel.test
run_test ./grouptools/groupdel/09_groupdel_delete_group_error_two_group_parameter/groupdel.test
run_test ./grouptools/groupmems/01_groupmems_root_add_user/groupmems.test
run_test ./grouptools/groupmems/02_groupmems_root_del_user/groupmems.test
run_test ./grouptools/groupmems/03_groupmems_root_del_user_admin/groupmems.test
run_test ./grouptools/groupmems/04_groupmems_root_del_user_admin_and_user/groupmems.test
run_test ./grouptools/groupmems/05_groupmems_root_add_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/06_groupmems_root_add_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/07_groupmems_root_del_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/08_groupmems_root_del_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/09_groupmems_root_purge_user/groupmems.test
run_test ./grouptools/groupmems/10_groupmems_root_purge_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/11_groupmems_root_purge_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/12_groupmems_user_add_user/groupmems.test
run_test ./grouptools/groupmems/13_groupmems_user_del_user/groupmems.test
run_test ./grouptools/groupmems/14_groupmems_user_del_user_admin/groupmems.test
run_test ./grouptools/groupmems/15_groupmems_user_del_user_admin_and_user/groupmems.test
run_test ./grouptools/groupmems/16_groupmems_user_add_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/17_groupmems_user_add_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/18_groupmems_user_del_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/19_groupmems_user_del_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/20_groupmems_user_purge_user/groupmems.test
run_test ./grouptools/groupmems/21_groupmems_user_purge_user_with_other_users/groupmems.test
run_test ./grouptools/groupmems/22_groupmems_user_purge_user_with_other_users_admin/groupmems.test
run_test ./grouptools/groupmems/23_groupmems_user_add_user-not_in_groups/groupmems.test
run_test ./grouptools/groupmems/24_groupmems_user_add_user-not_primary_group/groupmems.test
run_test ./grouptools/groupmems/25_groupmems_user_add_user-not_user_group/groupmems.test
run_test ./grouptools/groupmems/26_groupmems_user_add_user-already_member/groupmems.test
run_test ./grouptools/groupmems/27_groupmems_user_add_user-already_member_in_group/groupmems.test
run_test ./grouptools/groupmems/28_groupmems_user_add_user-already_member_in_gshadow/groupmems.test
run_test ./grouptools/groupmems/29_groupmems_user_add_user-user_does_not_exist/groupmems.test
run_test ./grouptools/groupmems/30_groupmems_user_add_user-no_gshadow_group/groupmems.test
run_test ./grouptools/groupmems/31_groupmems_user_add_user-no_gshadow_file/groupmems.test
run_test ./grouptools/groupmems/32_groupmems_user_del_user-not_member/groupmems.test
run_test ./grouptools/groupmems/33_groupmems_user_del_user-not_member_in_gshadow/groupmems.test
run_test ./grouptools/groupmems/34_groupmems_user_del_user-user_does_not_exist/groupmems.test
run_test ./grouptools/groupmems/35_groupmems_user_del_user-no_gshadow_group/groupmems.test
run_test ./grouptools/groupmems/36_groupmems_user_del_user-no_gshadow_file/groupmems.test
run_test ./grouptools/groupmems/37_groupmems_user_purge_user-empty_group/groupmems.test
run_test ./grouptools/groupmems/38_groupmems_user_purge_user-no_gshadow_group/groupmems.test
run_test ./grouptools/groupmems/39_groupmems_user_purge_user-no_gshadow_file/groupmems.test
run_test ./grouptools/groupmems/40_groupmems_user_del_user-not_primary_group/groupmems.test
run_test ./grouptools/groupmems/41_groupmems_user_purge_user-not_primary_group/groupmems.test
run_test ./grouptools/groupmems/42_groupmems_user_list_users/groupmems.test
run_test ./grouptools/groupmems/43_groupmems_user_list_users-gshadow_ignored/groupmems.test
run_test ./grouptools/groupmems/44_groupmems_user_list_users-another_group/groupmems.test
run_test ./grouptools/groupmems/45_groupmems_user_list_users-group_locked/groupmems.test
run_test ./grouptools/groupmems/46_groupmems_user_list_users-gshadow_locked/groupmems.test
run_test ./grouptools/groupmems/47_groupmems_user_add_user-group_locked/groupmems.test
run_test ./grouptools/groupmems/48_groupmems_user_add_user-gshadow_locked/groupmems.test
run_test ./grouptools/groupmems/49_groupmems_user_del_user-group_locked/groupmems.test
run_test ./grouptools/groupmems/50_groupmems_user_del_user-gshadow_locked/groupmems.test
run_test ./grouptools/groupmems/51_groupmems_user_purge_user-group_locked/groupmems.test
run_test ./grouptools/groupmems/52_groupmems_user_purge_user-gshadow_locked/groupmems.test
run_test ./grouptools/groupmod/01_groupmod_change_gid/groupmod.test
run_test ./grouptools/groupmod/02_groupmod_change_gid_change_primary_group/groupmod.test
run_test ./grouptools/groupmod/03_groupmod_change_gid_no_gshadow_group/groupmod.test
run_test ./grouptools/groupmod/04_groupmod_change_gid_no_gshadow_file/groupmod.test
run_test ./grouptools/groupmod/05_groupmod_change_gid_-o_override_used_GID/groupmod.test
run_test ./grouptools/groupmod/06_groupmod_change_group_name/groupmod.test
run_test ./grouptools/groupmod/07_groupmod_change_group_name_no_gshadow_group/groupmod.test
run_test ./grouptools/groupmod/08_groupmod_change_group_name_no_gshadow_file/groupmod.test
run_test ./grouptools/groupmod/09_groupmod_set_password/groupmod.test
run_test ./grouptools/groupmod/10_groupmod_set_password_no_gshadow_group/groupmod.test
run_test ./grouptools/groupmod/11_groupmod_set_password_no_gshadow_file/groupmod.test
run_test ./grouptools/groupmod/12_groupmod_change_gid_error_unknown_group/groupmod.test
run_test ./grouptools/groupmod/13_groupmod_change_gid_error_used_GID/groupmod.test
run_test ./grouptools/groupmod/14_groupmod_change_group_name_error_used_name/groupmod.test
run_test ./grouptools/groupmod/15_groupmod_change_group_name_error_invalid_name/groupmod.test
run_test ./grouptools/groupmod/16_groupmod_change_group_name_no_changes/groupmod.test
run_test ./grouptools/groupmod/17_groupmod_change_gid_error_locked_group/groupmod.test
run_test ./grouptools/groupmod/18_groupmod_change_gid_no_error_locked_gshadow/groupmod.test
run_test ./grouptools/groupmod/19_groupmod_change_gid_error_invalid_GID/groupmod.test
run_test ./grouptools/groupmod/20_groupmod_change_gid_error_negativ_GID/groupmod.test
run_test ./grouptools/groupmod/21_groupmod_change_gid_error_no_group/groupmod.test
run_test ./grouptools/groupmod/22_groupmod_change_gid_and_group_name/groupmod.test
run_test ./grouptools/groupmod/23_groupmod_change_gid_and_group_name_and_password/groupmod.test
run_test ./grouptools/groupmod/24_groupmod_change_gid_and_name_error_locked_gshadow/groupmod.test
run_test ./grouptools/groupmod/25_groupmod_change_gid_change_primary_group_error_locked_passwd/groupmod.test
run_test ./grouptools/groupmod/26_groupmod_change_group_name_no_error_locked_passwd/groupmod.test
run_test ./grouptools/groupmod/27_groupmod_change_gid_error_GID_4294967295/groupmod.test
run_test ./usertools/01/01_useradd_add_user.test
run_test ./usertools/01/01_userdel_delete_user.test
run_test ./usertools/01/02_useradd_recreate_deleted_user.test
run_test ./usertools/01/03_useradd_additional_options.test
run_test ./usertools/01/04_useradd_add_user_with_existing_UID_fail.test
run_test ./usertools/01/04_useradd_add_user_with_existing_UID_with_-o.test
run_test ./usertools/01/04_useradd_specified_UID.test
run_test ./usertools/01/04_useradd_specified_UID_and_GID.test
run_test ./usertools/01/04_userdel_delete_user_with_non_unique_UID.test
run_test ./usertools/01/05_useradd_invalid_numeric_primary_group.test
run_test ./usertools/01/06_useradd_invalid_named_primary_group.test
run_test ./usertools/01/07_useradd_numerical_primary_group.test
run_test ./usertools/01/08_useradd_named_primary_group.test
run_test ./usertools/01/09_usermod_change_user_info.test
run_test ./usertools/01/10_usermod_rename_user.test
run_test ./usertools/01/10_usermod_rename_user_in_group.test
run_test ./usertools/01/11_usermod_change_password.test
run_test ./usertools/01/11_usermod_lock_password.test
run_test ./usertools/01/11_usermod_unlock_empty_password.test
run_test ./usertools/01/11_usermod_unlock_password.test
run_test ./usertools/01/12_usermod_change_gid_name.test
run_test ./usertools/01/12_usermod_change_gid_number.test
run_test ./usertools/01/13_useradd_negative_UID.test
run_test ./usertools/01/14_useradd_out_of_range_UID.test
run_test ./usertools/01/15_useradd_specified_large_UID.test
run_test ./usertools/01/16_useradd_add_user_to_multiple_groups.test
run_test ./usertools/01/16_useradd_add_user_to_one_group.test
run_test ./usertools/01/17_useradd_create_homedir.test
run_test ./usertools/01/18_userdel_remove_homedir.test
run_test ./usertools/01/19_userdel_delete_user_in_group.test
run_test ./usertools/01/20_usermod_change_homedir.test
run_test ./usertools/01/21_usermod_change_and_move_homedir.test
run_test ./usertools/01/22_usermod_new_groups.test
run_test ./usertools/01/23_usermod_add_groups.test
run_test ./usertools/01/24_usermod_new_groups_remove_old_groups.test
run_test ./usertools/01/25_useradd_specified_large_UID2.test
run_test ./usertools/01/26_useradd_UID_-1.test
run_test ./usertools/02/useradd_default_default_values.test
run_test ./usertools/02/useradd_get_default_values.test
run_test ./usertools/02/useradd_change_default_INACTIVE.test
run_test ./usertools/02/useradd_change_default_SHELL.test
run_test ./usertools/02/useradd_change_default_EXPIRE.test
run_test ./usertools/02/useradd_change_default_GROUP.test
run_test ./usertools/02/useradd_change_default_HOME.test
run_test ./usertools/02/useradd_change_defaults.test
run_test ./usertools/03/useradd_change_defaults.test
run_test ./usertools/04/01_useradd_add_user.test
run_test ./usertools/05_userdel_del_from_group_members/userdel.test
run_test ./usertools/06_userdel_del_from_gshadow_members/userdel.test
run_test ./usertools/07_userdel_del_from_gshadow_admins/userdel.test
run_test ./usertools/08_userdel_del_from_group_and_gshadow/userdel.test
run_test ./usertools/09_userdel_del_homedir/userdel.test
run_test ./usertools/10_userdel_del_homedir_wrong_owner/userdel.test
run_test ./usertools/11_usermod_move_homedir/usermod.test
run_test ./usertools/12_usermod_move_homedir_dev_null/usermod.test
run_test ./usertools/13_usermod_move_homedir_file/usermod.test
run_test ./usertools/14_usermod_move_homedir_other_device/usermod.test
run_test ./usertools/15_usermod_change_supplementary_groups/usermod.test
run_test ./usertools/16_usermod_remove_supplementary_groups/usermod.test
run_test ./usertools/17_usermod_change_supplementary_groups_numerical/usermod.test
run_test ./usertools/18_usermod_change_supplementary_groups-unknown_group/usermod.test
run_test ./usertools/19_usermod_change_supplementary_groups-unknown_numerical_group/usermod.test
run_test ./usertools/20_usermod_rename_user_in_member_lists/usermod.test
run_test ./usertools/21_usermod_rename_user_in_member_lists-and-add_supplementary_groups/usermod.test
run_test ./usertools/22_usermod-a_existing_supplementary_group/usermod.test
run_test ./usertools/23_usermod-a_existing_supplementary_group+rename/usermod.test
run_test ./usertools/24_usermod_locked_passwd/usermod.test
run_test ./usertools/25_usermod-G_locked_group/usermod.test
run_test ./usertools/26_usermod_locked_shadow/usermod.test
run_test ./usertools/27_usermod-G_locked_gshadow/usermod.test
run_test ./usertools/28_usermod-c_locked_group/usermod.test
run_test ./usertools/29_usermod-c_locked_gshadow/usermod.test
run_test ./usertools/30_usermod-l_locked_group/usermod.test
run_test ./usertools/31_usermod-l_locked_gshadow/usermod.test
run_test ./usertools/32_usermod-u_new_UID/usermod.test
run_test ./usertools/33_usermod-u_existing_UID/usermod.test
run_test ./usertools/34_usermod-u-o_existing_UID/usermod.test
run_test ./usertools/35_usermod-u_invalid_UID/usermod.test
run_test ./usertools/36_usermod_change_uid+move_homedir_other_device/usermod.test
run_test ./usertools/37_Debian_Bug_470745/usermod.test
run_test ./usertools/38_usermod_invalid_user/usermod.test
run_test ./usertools/39_usermod_-c_invalid_comment/usermod.test
run_test ./usertools/40_usermod_-d_invalid_homedir/usermod.test
run_test ./usertools/41_usermod_-d_invalid_shell/usermod.test
run_test ./usertools/42_usermod_-g_invalid_group_name/usermod.test
run_test ./usertools/43_usermod_-g_invalid_group_ID/usermod.test
run_test ./usertools/44_usermod-l_existing_username/usermod.test
run_test ./usertools/45_usermod-l_existing_username_passwd/usermod.test
run_test ./usertools/46_usermod-l_existing_username_shadow/usermod.test
run_test ./usertools/47_usermod-l_no_shadow_file/usermod.test
run_test ./usertools/48_userdel_keep_group_if_primary_other_user/userdel.test
run_test ./usertools/49_userdel_delete_users_group/userdel.test
run_test ./usertools/50_userdel_delete_users_group_no_gshadow_group/userdel.test
run_test ./usertools/51_userdel_delete_users_group_no_gshadow_file/userdel.test
run_test ./usertools/52_userdel_delete_user_no_shadow_entry/userdel.test
run_test ./usertools/53_userdel_delete_user_no_shadow_file/userdel.test
run_test ./usertools/54_usermod-u_invalid_UID_4294967295/usermod.test
run_test ./usertools/55_userdel_busy_user/userdel.test
run_test ./usertools/56_userdel_locked_passwd/userdel.test
run_test ./usertools/57_userdel_locked_group/userdel.test
run_test ./usertools/58_userdel_locked_shadow/userdel.test
run_test ./usertools/59_userdel_locked_gshadow/userdel.test
run_test ./usertools/60_userdel_invalid_user/userdel.test
run_test ./usertools/61_userdel_del_homedir_with_symlinks/userdel.test
if [ "$USE_PAM" = "yes" ]; then
	run_test ./usertools/chpasswd-PAM/01_chpasswd_invalid_user/chpasswd.test
	run_test ./usertools/chpasswd-PAM/02_chpasswd_multiple_users/chpasswd.test
	run_test ./usertools/chpasswd-PAM/03_chpasswd_no_shadow_file/chpasswd.test
	run_test ./usertools/chpasswd-PAM/04_chpasswd_no_shadow_entry/chpasswd.test
	run_test ./usertools/chpasswd-PAM/05_chpasswd_error_no_password/chpasswd.test
else
	run_test ./usertools/chpasswd/01_chpasswd_invalid_user/chpasswd.test
	run_test ./usertools/chpasswd/02_chpasswd_multiple_users/chpasswd.test
	run_test ./usertools/chpasswd/03_chpasswd_no_shadow_file/chpasswd.test
	run_test ./usertools/chpasswd/04_chpasswd_no_shadow_entry/chpasswd.test
	run_test ./usertools/chpasswd/05_chpasswd_error_no_password/chpasswd.test
fi
run_test ./cptools/01/run1
run_test ./cptools/01/run2
run_test ./cptools/01/run3
run_test ./cptools/01/run4
run_test ./cktools/01/run1
run_test ./cktools/01/run2
run_test ./cktools/02_pwck_sort/pwck.test
run_test ./cktools/03_grpck_sort/grpck.test
run_test ./cktools/04_pwck_sort_missing_shadow_user/pwck.test
run_test ./cktools/05_grpck_sort_missing_shadow_group/grpck.test
run_test ./cktools/grpck/04_grpck_missing_field_group_delete/grpck.test
run_test ./cktools/grpck/05_grpck_missing_field_group_keep/grpck.test
run_test ./cktools/grpck/06_grpck_missing_field_group_no_changes/grpck.test
run_test ./cktools/grpck/07_grpck_missing_field_gshadow_add/grpck.test
run_test ./cktools/grpck/08_grpck_missing_field_gshadow_delete/grpck.test
run_test ./cktools/grpck/09_grpck_missing_field_gshadow_no_changes/grpck.test
run_test ./cktools/grpck/10_grpck_missing_field_group_local/grpck.test
run_test ./cktools/grpck/11_grpck_missing_field_gshadow_local/grpck.test
run_test ./cktools/grpck/12_grpck_unknown_user_group/grpck.test
run_test ./cktools/grpck/13_grpck_unknown_user_gshadow/grpck.test
run_test ./cktools/grpck/14_grpck_unknown_user_adm_gshadow/grpck.test
run_test ./cktools/grpck/15_grpck_unknown_user_duplicate_group/grpck.test
run_test ./cktools/grpck/16_grpck_duplicate_entry_group/grpck.test
run_test ./cktools/grpck/17_grpck_duplicate_entry_gshadow/grpck.test
run_test ./cktools/grpck/18_grpck_duplicate_entry_group_no_changes/grpck.test
run_test ./cktools/grpck/19_grpck_duplicate_entry_gshadow_no_changes/grpck.test
run_test ./cktools/grpck/20_grpck_duplicate_entry_gshadow_delete_second/grpck.test
run_test ./cktools/grpck/21_grpck_invalid_group_name/grpck.test
run_test ./cktools/grpck/22_grpck_invalid_group_ID_-1/grpck.test
run_test ./cktools/grpck/23_grpck_invalid_group_ID_4294967295/grpck.test
run_test ./cktools/grpck/24_grpck_invalid_group_ID_4294967296/grpck.test
run_test ./cktools/grpck/25_grpck_unknown_user_group_no_changes/grpck.test
run_test ./cktools/pwck/04_pwck_missing_field_passwd_delete/pwck.test
run_test ./cktools/pwck/05_pwck_missing_field_passwd_keep/pwck.test
run_test ./cktools/pwck/06_pwck_missing_field_passwd_no_changes/pwck.test
run_test ./cktools/pwck/07_pwck_missing_field_shadow_add/pwck.test
run_test ./cktools/pwck/08_pwck_missing_field_shadow_delete/pwck.test
run_test ./cktools/pwck/09_pwck_missing_field_shadow_no_changes/pwck.test
run_test ./cktools/pwck/10_pwck_missing_field_passwd_local/pwck.test
run_test ./cktools/pwck/11_pwck_missing_field_shadow_local/pwck.test
run_test ./cktools/pwck/12_pwck_unknown_user_group_ID/pwck.test
run_test ./cktools/pwck/13_pwpck_duplicate_entry_passwd/pwck.test
run_test ./cktools/pwck/14_pwck_duplicate_entry_shadow/pwck.test
run_test ./cktools/pwck/15_pwck_duplicate_entry_passwd_no_changes/pwck.test
run_test ./cktools/pwck/16_pwck_duplicate_entry_shadow_no_changes/pwck.test
run_test ./cktools/pwck/17_pwck_duplicate_entry_passwd_delete_second/pwck.test
run_test ./cktools/pwck/18_pwck_invalid_user_name/pwck.test
run_test ./cktools/pwck/19_pwck_invalid_user_ID_-1/pwck.test
run_test ./cktools/pwck/20_pwck_invalid_user_ID_4294967295/pwck.test
run_test ./cktools/pwck/21_pwck_invalid_user_ID_4294967296/pwck.test
if [ "$USE_PAM" != "yes" ]; then
	run_test ./crypt/login.defs_DES-MD5_CRYPT_ENAB/01_chpasswd.test
	run_test ./crypt/login.defs_DES/01_chpasswd.test
	run_test ./crypt/login.defs_DES/02_chpasswd--crypt-method-MD5.test
	run_test ./crypt/login.defs_DES/03_chpasswd--crypt-method-DES.test
	run_test ./crypt/login.defs_DES/04_chpasswd--crypt-method-NONE.test
	run_test ./crypt/login.defs_DES/05_chpasswd-e.test
	run_test ./crypt/login.defs_DES/06_chpasswd-m.test
fi
run_test ./crypt/login.defs_DES/07_chgpasswd.test
run_test ./crypt/login.defs_DES/08_chgpasswd--crypt-method-MD5.test
run_test ./crypt/login.defs_DES/09_chgpasswd--crypt-method-DES.test
run_test ./crypt/login.defs_DES/10_chgpasswd--crypt-method-NONE.test
run_test ./crypt/login.defs_DES/11_chgpasswd-e.test
run_test ./crypt/login.defs_DES/12_chgpasswd-m.test
if [ "$USE_PAM" != "yes" ]; then
	run_test ./crypt/login.defs_MD5/01_chpasswd.test
	run_test ./crypt/login.defs_MD5_CRYPT_ENAB/01_chpasswd.test
fi
run_test ./crypt/login.defs_MD5/02_chgpasswd.test
run_test ./crypt/login.defs_MD5_CRYPT_ENAB/02_chgpasswd.test
if [ "$USE_PAM" != "yes" ]; then
	run_test ./crypt/login.defs_SHA256-round-max/01_chpasswd.test
	run_test ./crypt/login.defs_SHA256-round-min-max/01_chpasswd.test
	run_test ./crypt/login.defs_SHA256-round-min/01_chpasswd.test
	run_test ./crypt/login.defs_SHA256/01_chpasswd.test
	run_test ./crypt/login.defs_SHA512/01_chpasswd.test
	run_test ./crypt/login.defs_none/01_chpasswd.test
fi
run_test ./crypt/login.defs_SHA256-round-max/02_chgpasswd.test
run_test ./crypt/login.defs_SHA256-round-min-max/02_chgpasswd.test
run_test ./crypt/login.defs_SHA256-round-min/02_chgpasswd.test
run_test ./crypt/login.defs_SHA256/02_chgpasswd.test
run_test ./crypt/login.defs_SHA512/02_chgpasswd.test
run_test ./crypt/login.defs_none/02_chgpasswd.test
run_test ./newusers/01_create_user/newusers.test
run_test ./newusers/02_update_password/newusers.test
run_test ./newusers/03_no_update_pid/newusers.test
run_test ./newusers/04_no_update_gid/newusers.test
run_test ./newusers/05_create_user_pid/newusers.test
run_test ./newusers/06_create_user_gid/newusers.test
run_test ./newusers/07_create_user_pid_gid/newusers.test
run_test ./newusers/08_create_user_pid_other-gid/newusers.test
run_test ./newusers/09_create_user_pid-as-user-bar/newusers.test
run_test ./newusers/10_create_user_gid-as-group-bar/newusers.test
run_test ./newusers/11_update_gecos/newusers.test
run_test ./newusers/12_update_shell/newusers.test
run_test ./newusers/13_create_user_new-home/newusers.test
run_test ./newusers/14_create_user_existing-home/newusers.test
run_test ./newusers/15_update_new-home/newusers.test
run_test ./newusers/16_update_existing-home/newusers.test
run_test ./newusers/17_create_user_pid-already-used/newusers.test
run_test ./newusers/18_create_user_gid-already-used/newusers.test
run_test ./newusers/19_update_keep-old-home/newusers.test
run_test ./newusers/20_multiple_users/newusers.test
run_test ./newusers/21_create_user_UID_MAX/newusers.test
run_test ./newusers/22_create_user_GID_MAX/newusers.test
run_test ./newusers/23_create_user_error_negativ_UID/newusers.test
run_test ./newusers/24_create_user_error_invalid_UID/newusers.test
run_test ./newusers/25_create_user_error_no_remaining_UID/newusers.test
run_test ./newusers/26_create_user_error_no_remaining_GID/newusers.test
run_test ./newusers/27_create_user_error_invalid_username/newusers.test
run_test ./newusers/28_create_user_error_invalid_groupname/newusers.test
run_test ./newusers/29_create_user_error_invalid_username_valid_groupname/newusers.test
run_test ./newusers/30_create_user_different_groupname/newusers.test
run_test ./newusers/31_create_user_error_invalid_GID/newusers.test
run_test ./newusers/32_create_user_error_gshadow_group_exists/newusers.test
run_test ./newusers/33_update_password_no_shadow_password/newusers.test
run_test ./newusers/34_update_password_no_shadow/newusers.test
run_test ./newusers/35_read_from_stdin/newusers.test
if [ "$USE_PAM" != "yes" ]; then
	run_test ./newusers/36_create_user_encrypted/newusers.test
	run_test ./newusers/37_create_user_encrypt_MD5/newusers.test
	run_test ./newusers/38_update_password_no_shadow_encrypted/newusers.test
	run_test ./newusers/39_update_password_no_shadow_password_encrypted/newusers.test
	run_test ./newusers/40_update_password_encrypted/newusers.test
	run_test ./newusers/41_create_user_encrypt_SHA256/newusers.test
	run_test ./newusers/42_create_user_encrypt_SHA512/newusers.test
	run_test ./newusers/43_create_user_encrypt_SHA256_rounds_3000/newusers.test
	run_test ./newusers/44_create_user_encrypt_SHA256_rounds_300/newusers.test
	run_test ./newusers/45_create_user_encrypt_rounds_3000/newusers.test
	run_test ./newusers/46_create_user_encrypt_MD5_ignore_rounds_3000/newusers.test
else

	run_test ./newusers/37_create_user_encrypt_MD5-PAM/newusers.test



	run_test ./newusers/41_create_user_encrypt_SHA256-PAM/newusers.test
	run_test ./newusers/42_create_user_encrypt_SHA512-PAM/newusers.test
	run_test ./newusers/43_create_user_encrypt_SHA256_rounds_3000-PAM/newusers.test
	run_test ./newusers/44_create_user_encrypt_SHA256_rounds_300-PAM/newusers.test


fi
run_test ./newusers/47_create_user_error_UID_4294967295/newusers.test
run_test ./newusers/48_create_user_error_GID_4294967295/newusers.test
run_test ./newusers/49_multiple_system_users/newusers.test
run_test ./split_groups/01_useradd_split_group/useradd.test
run_test ./split_groups/02_useradd_no_split_group/useradd.test
run_test ./split_groups/03_useradd_split_group_already_split/useradd.test
run_test ./split_groups/04_useradd_split_group_already_full/useradd.test
run_test ./split_groups/05_useradd_split_group_already_split_passwd_differ/useradd.test
run_test ./split_groups/06_useradd_split_group_already_split_GID_differ/useradd.test
run_test ./split_groups/07_useradd_split_group_already_split_user_in_both_lines/useradd.test
run_test ./split_groups/08_useradd_no_split_group_already_split/useradd.test
run_test ./split_groups/09_groupdel_split_group_already_split/groupdel.test
run_test ./split_groups/10_groupdel_no_split_group_already_split/groupdel.test
run_test ./failures/groupmod/01_groupmod_change_group_name_gshadow_rename_failure/groupmod.test
run_test ./failures/groupmod/02_groupmod_change_gid_change_primary_group_passwd_rename_failure/groupmod.test
run_test ./failures/groupmod/03_groupmod_change_group_name_group_rename_failure/groupmod.test
run_test ./failures/userdel/01_userdel_gshadow_rename_failure/userdel.test
run_test ./failures/userdel/02_userdel_group_rename_failure/userdel.test
run_test ./failures/userdel/03_userdel_shadow_rename_failure/userdel.test
run_test ./failures/userdel/04_userdel_passwd_rename_failure/userdel.test
run_test ./failures/userdel/05_userdel_failure_remove_mailbox/userdel.test
run_test ./failures/userdel/06_userdel_failure_remove_file_homedir/userdel.test
run_test ./failures/userdel/07_userdel_failure_remove_homedir/userdel.test
run_test ./failures/usermod/01_usermod_change_user_name_gshadow_rename_failure/usermod.test
run_test ./failures/usermod/02_usermod_change_uid_passwd_rename_failure/usermod.test
run_test ./failures/usermod/03_usermod_change_user_name_group_rename_failure/usermod.test
run_test ./failures/usermod/04_usermod_change_user_name_gshadow_rename_no_failure/usermod.test
run_test ./failures/usermod/05_usermod_change_uid_shadow_rename_failure/usermod.test
run_test ./expiry/01_expiry_-c_no_expiry/expiry.test
run_test ./expiry/02_expiry_-c_expired/expiry.test
run_test ./expiry/03_expiry_-f_expired/expiry.test
run_test ./expiry/04_expiry_no_options/expiry.test
run_test ./expiry/05_expiry_-c_no_shadow_file/expiry.test
run_test ./expiry/06_expiry_-c_no_shadow_entry/expiry.test
run_test ./expiry/07_expiry_-c_expired_account/expiry.test
run_test ./expiry/08_expiry_-c_expired_max+inact/expiry.test
run_test ./expiry/09_expiry_-c_expired_not_inactive/expiry.test
run_test ./passwd/01_passwd_-S_root_locked_account/passwd.test
run_test ./passwd/02_passwd_-S_root_valid_account/passwd.test
run_test ./passwd/03_passwd_-S_root_empty_password/passwd.test
run_test ./passwd/04_passwd_-S_root_valid_account_no_shadow_file/passwd.test
run_test ./passwd/05_passwd_-S_root_valid_account_no_shadow_entry/passwd.test
run_test ./passwd/06_passwd_-l_root_lock_account/passwd.test
run_test ./passwd/07_passwd_-l_root_lock_account_no_shadow_entry/passwd.test
run_test ./passwd/08_passwd_-u_root_unlock_account/passwd.test
run_test ./passwd/09_passwd_-u_root_unlock_to_empty/passwd.test
run_test ./passwd/10_passwd_-d_root/passwd.test
run_test ./passwd/11_passwd_--mindays_root/passwd.test
run_test ./passwd/12_passwd_--maxdays_root/passwd.test
run_test ./passwd/13_passwd_--warndays_root/passwd.test
run_test ./passwd/14_passwd_--inactive_root/passwd.test
run_test ./passwd/15_passwd_--expire_root/passwd.test
run_test ./passwd/16_passwd_-S-a_root/passwd.test
run_test ./passwd/17_passwd_root_change_password/passwd.test
run_test ./passwd/18_passwd_root_change_password_user/passwd.test
run_test ./passwd/19_passwd_user_change_password/passwd.test
run_test ./passwd/20_passwd_user_change_password_same_user/passwd.test
run_test ./passwd/21_passwd_user_change_password_other_user/passwd.test
run_test ./login/01_login_prompt/login.test
run_test ./login/02_login_user/login.test
run_test ./login/03_login_check_tty/login.test

echo
echo "$succeded test(s) passed"
echo "$failed test(s) failed"
echo "log written in 'testsuite.log'"
if [ "$failed" != "0" ]
then
	echo "the following tests failed:"
	echo $failed_tests
fi

