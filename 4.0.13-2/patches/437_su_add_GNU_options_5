Goal: report failure to execute the shell to the user and to syslog.
      Also, return a 126 or 127 exit status when !USE_PAM (was mising
      from another patch.

Index: shadow-4.0.13/src/su.c
===================================================================
--- shadow-4.0.13.orig/src/su.c	2005-10-04 08:07:18.106641636 +0200
+++ shadow-4.0.13/src/su.c	2005-10-04 08:07:18.807498832 +0200
@@ -232,6 +232,13 @@
 
 #ifndef USE_PAM
 	(void) execv (shellstr, args);
+	fprintf (stderr, _("No shell\n"));
+	SYSLOG((LOG_WARN, "Cannot execute %s\n", shellstr));
+	{
+		int exit_status = (errno == ENOENT ? 127 : 126);
+
+		exit (exit_status);
+	}
 	/* NOT REACHED */
 #else
 	child = fork ();
@@ -239,6 +246,8 @@
 		pam_end (pamh, PAM_SUCCESS);
 
 		(void) execv (shellstr, (char **) args);
+		fprintf (stderr, _("No shell\n"));
+		SYSLOG((LOG_WARN, "Cannot execute %s\n", shellstr));
 		{
 			int exit_status = (errno == ENOENT ? 127 : 126);
 
